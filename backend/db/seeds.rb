Image.create([
  {target_type: 1, title: "アナルほじりたいマン", deleted: false, url: "https://twitter.com/AliceCatharsis/status/1160706668419674113", thumbnail: "https://pbs.twimg.com/media/EBuojldWwAAMBEj?format=jpg&name=medium"},
  {target_type: 0, adjusty: '{"width": "350%", "top": "-150px", "left": "-600px"}', title: "ベラちゃん", deleted: false, url: "https://twitter.com/AliceCatharsis/status/1162160144915914759", thumbnail: "https://pbs.twimg.com/media/ECDSfOLU8AUIuCp?format=jpg&name=medium"},
  {target_type: 0, adjusty: '{"width": "300%", "top": "-220px", "left": "-280px"}', title: "悪そうなアリス", deleted: false, url: "https://twitter.com/AliceCatharsis/status/1168461532042186753", thumbnail: "https://pbs.twimg.com/media/EDc1kO4U4AE6Bm5?format=jpg&name=large"},
  {target_type: 1, title: "アリスでディープスロート", deleted: false, url: "https://twitter.com/AliceCatharsis/status/1179405362669207554", thumbnail: "https://pbs.twimg.com/media/EF4W6j-XkAEnvyS?format=jpg&name=medium"},
  {target_type: 0, title: "実在する誰か", deleted: false, url: "https://twitter.com/AliceCatharsis/status/1205143918465040386", thumbnail: "https://pbs.twimg.com/media/ELmIAPFU0AAv6OQ?format=jpg&name=medium"},
  {target_type: 0, adjusty: '{"width": "100%", "top": "-20px", "left": "0px"}', title: "なんか頑張った絵", deleted: false, url: "https://twitter.com/AliceCatharsis/status/1206992173209538560", thumbnail: "https://pbs.twimg.com/media/EMAY-dhUEAAWz2x?format=jpg&name=medium"},
  {target_type: 0, adjusty: '{"width": "300%", "top": "-220px", "left": "-280px"}', title: "設定画的なやつ", deleted: false, url: "https://twitter.com/AliceCatharsis/status/1207373597607546881", thumbnail: "https://pbs.twimg.com/media/EMFz4d4U8AELq_u?format=jpg&name=medium"},
  {target_type: 0, adjusty: '{"width": "300%", "top": "-220px", "left": "-280px"}', title: "設定画的なやつ②", deleted: false, url: "https://twitter.com/AliceCatharsis/status/1208114392543322112", thumbnail: "https://pbs.twimg.com/media/EMQVob0VAAAXEBz?format=png&name=medium"},
  {target_type: 0, title: "りあむ", deleted: false, url: "https://twitter.com/AliceCatharsis/status/1209100260410187777", thumbnail: "https://pbs.twimg.com/media/EMeWRmMU8AEN2kx?format=jpg&name=large"},
  {target_type: 1, title: "水龍敬ランドにいそうなアリスになってしまった・・・", deleted: false, url: "https://twitter.com/AliceCatharsis/status/1212692106038276098", thumbnail: "https://pbs.twimg.com/media/ENRZCJsUEAATMnk?format=jpg&name=large"},
  {target_type: 0, title: "轟くゅ", deleted: false, url: "https://twitter.com/AliceCatharsis/status/1214543848115802112", thumbnail: "https://pbs.twimg.com/media/ENrtML7UUAAoFuP?format=jpg&name=medium"},
  {target_type: 0, title: "いまアイコンに使ってる絵", deleted: false, url: "https://twitter.com/AliceCatharsis/status/1215289810148978688", thumbnail: "https://pbs.twimg.com/media/EN2ToxeVUAALN2S?format=jpg&name=large"},
  {target_type: 1, title: "とくになし", deleted: false, url: "https://twitter.com/AliceCatharsis/status/1239185082436345856", thumbnail: "https://pbs.twimg.com/media/ETJ4ENGUwAAMPy8?format=png&name=small"},
  {target_type: 1, title: "揉みたい乳房（蹴りたい背中並感）", deleted: false, url: "https://twitter.com/AliceCatharsis/status/1249700377919770624", thumbnail: "https://pbs.twimg.com/media/EVfTyqVUEAMqLH9?format=jpg&name=large"},
  {target_type: 0, title: "落書きだと思う", deleted: false, url: "https://twitter.com/AliceCatharsis/status/1250490659242270720", thumbnail: "https://pbs.twimg.com/media/EVqiNqkUwAA6wnH?format=png&name=900x900"},
  {target_type: 0, title: "現在の絵柄で普通にアリス書いた", deleted: false, url: "https://twitter.com/AliceCatharsis/status/1251423443288915968", thumbnail: "https://pbs.twimg.com/media/EV3yyOiUwAEBgIV?format=jpg&name=large"},
  {target_type: 0, title: "ぴえん系女子", deleted: false, url: "https://twitter.com/AliceCatharsis/status/1251696029075816449", thumbnail: "https://pbs.twimg.com/media/EV7qypOU8AEYHaQ?format=jpg&name=large"},
  {target_type: 0, title: "#美少女コンペ2020前夜祭", deleted: false, url: "https://twitter.com/AliceCatharsis/status/1251984974913257472", thumbnail: "https://pbs.twimg.com/media/EV_w4n-UYAAeIrb?format=jpg&name=medium"},
  {target_type: 0, title: "ファンボックス開始記念", deleted: false, url: "https://twitter.com/AliceCatharsis/status/1258047488994336768", thumbnail: "https://pbs.twimg.com/media/EXV7gCNU8AYDGXA?format=jpg&name=4096x4096"},
  {target_type: 1, title: "キスショットアセロラオリオンハートアンダーブレード", deleted: false, url: "https://twitter.com/AliceCatharsis/status/1258487612420972544", thumbnail: "https://pbs.twimg.com/media/EXcLswuU4AALF-B?format=jpg&name=medium"},
  {target_type: 1, title: "いらまちるの4", deleted: false, url: "https://kate-ac.fanbox.cc/posts/1056007", thumbnail: "https://pbs.twimg.com/media/EYNkPmgU4AE_4RB?format=jpg&name=large"},
  {target_type: 0, title: "戦慄の28歳さん", deleted: false, url: "https://twitter.com/AliceCatharsis/status/1265249050040791042", thumbnail: "https://pbs.twimg.com/media/EY8RKOJU0AAevR_?format=jpg&name=4096x4096"},
  {target_type: 0, title: "ぴえん系レムりん", deleted: false, url: "https://twitter.com/AliceCatharsis/status/1287395153179602944", thumbnail: "https://pbs.twimg.com/media/Ed2-_JmUYAAiakf?format=png&name=large"},
  {target_type: 1, title: "小顔だなーと思ってたら体が結構だらしなくてバーン！（語彙力）", deleted: false, url: "https://twitter.com/AliceCatharsis/status/1289853140066418688", thumbnail: "https://pbs.twimg.com/media/EeZ6S7HUYAAGEEv?format=png&name=4096x4096"},
  {target_type: 1, title: "舌射 #パイズリの日", deleted: false, url: "https://twitter.com/AliceCatharsis/status/1293564596628811777", thumbnail: "https://pbs.twimg.com/media/EfOqH4RUEAEYvGY?format=jpg&name=medium"},
  {target_type: 1, title: "2枚目 #パイズリの日", deleted: false, url: "https://twitter.com/AliceCatharsis/status/1293584697574842368", thumbnail: "https://pbs.twimg.com/media/EfO8V3_VoAA2qym?format=jpg&name=large"},
  {target_type: 1, title: "小学校の頃からの親友（野球部）に女装癖があることをカミングアウトした。「俺が童貞捨てさせてやるか？笑」と冗談のつもりで言ったら彼を本気にさせてしまった。", deleted: false, url: "https://twitter.com/AliceCatharsis/status/1295009851630686208", thumbnail: "https://pbs.twimg.com/media/EfjMhK1UcAIzB_j?format=jpg&name=4096x4096"},
  {target_type: 1, title: "彼女（？）が男の娘の話", deleted: false, url: "https://twitter.com/AliceCatharsis/status/1296020861439209472", thumbnail: "https://pbs.twimg.com/media/Efxj7x2UMAAAYj9?format=jpg&name=medium"},
  {target_type: 0, title: "彼女とデートなうに使っていいよのやつ", deleted: false, url: "https://twitter.com/AliceCatharsis/status/1297028572448608256", thumbnail: "https://pbs.twimg.com/media/Ef_4hvqU8AAdjjj?format=jpg&name=large"}
])

Tag.create([
  {name: '日常', color: '#ff7893'},
  {name: 'PHP', color: '#da6bff'},
  {name: '技術', color: '#78dfff'}
])

Memo.create([
  {tag_id: 1, title: "近況", deleted: false, published_at: "2016-12-16 00:00:00", body: <<-"EOF"
<p>
  使い道を決めかねているページです。<br>
  旧サイトで言うところの日記みたいな感じにしようかと思っていたんですが、<br>
  さほど書きたいこともないので廃止される可能性があります。<br>
  同人とかやってたら宣伝とかできるんですけど、その予定も今のところなく。<br>
  （お前なんか制作中ですとか言ってなかった？とかそういう突っ込みはナシで）<br>
</p>
<p>
  少し僕の近況をお話しさせていただくと、<br>
  この文章を書いている2016年12月現在、もう2年くらい絵を描いていません。<br>
  普通に社会人になって余裕がなくなったというのと、<br>
  絵を描いて飯を食っていこうみたいな意気込みがなくなってしまったからでした。<br>
  絵を描かなくなる2年くらい前から薄々感じていた事ではありますが、才能もセンスも無かったんですね。<br>
  描くのを辞めるまでは多分それを認められなかったんでしょう。<br>
  絵を描くのが好きで、絵の仕事の休憩中にすらお絵かきしてる人とかいますけど、<br>
  正直そういう人と比べると別にお絵かきが好きではなく、一生の仕事とするのは無理だと悟ったからです。<br>
  普通に動画見たりゲームしたいです。<br>
  結局好きなタイミングで描いている時が一番楽しいので、趣味でいいやという結論になりました。<br>
</p>
<p>
  そしてまた絵を描き始めるかなあーと思い、サイトも一新したわけです。<br>
  前のサイトは個人のレンタルサーバーだったのですが、<br>
  データが吹っ飛んだらしく管理者の方が失踪したっぽいのでもうどうにもできないです。<br>
  それも一新の理由ではあります。<br>
  以前にも1年半くらい絵を描かなかった時期がありましたが、今回の放置期間は過去最長ですね。
</p>
EOF
  },
  {tag_id: 2, title: "AmazonSNSをPHPで雑に扱う", deleted: false, published_at: "2019-12-29 00:00:00", body: <<-"EOF"
<p>
  SNSはAmazon Simple Notification Serviceの略。<br>
  仕事で使いそうな感じだったので試してみた。<br>
</p>
<p>
  ざっくり言うとメッセージを登録したサブスクリプション（エンドポイント）に対して送信してくれるサービス。<br>
  HTTPSやEメール等のプロトコルが選択できる。<br>
</p>
<p>
  今回このホームページにエンドポイントを生やしてみた。<br>
  http://alice-catharsis.mydns.jp/test/sns<br>
</p>
<p>
  AWSコンソールからポチポチとリクエストの確認を送信してみるが、エンドポイントのログに空が入る。<br>
  $_POST変数にメッセージが入ってるかと思いきや入っておらず、php://inputの中を見ると入っていた。<br>
</p>
<p>
  リファレンスを見ると$_POSTに入るデータは<br>
  > Content-Type に application/x-www-form-urlencoded<br>
  > あるいは multipart/form-data を用いた HTTP リクエスト<br>
  とあるのでそのどちらでもないということだ。<br>
</p>
<p>
  なので明示的にcurlで$_POSTとfile_get_contents('php://input')の場合に何が入るのか試した。<br>
  <pre>
    <code class="bash">
      curl -k -H "Content-Type: application/x-www-form-urlencoded" -X POST https://alice-catharsis.mydns.jp/test/sns -d "hoge"
      // {"hoge": ""} hoge

      curl -k -H "Content-Type: application/json" -X POST https://alice-catharsis.mydns.jp/test/sns -d "hoge"
      // [] hoge
    </code>
  </pre>
</p>
<p>
  なるほど。<br>
  というかAWSのリファレンスに普通にtext/plainって書いてた。<br>
  <a href="https://docs.aws.amazon.com/ja_jp/sns/latest/dg/sns-message-and-json-formats.html" target="_blank">https://docs.aws.amazon.com/ja_jp/sns/latest/dg/sns-message-and-json-formats.html</a><br>
</p>
<p>
  しかしこれだけではまだSNSからメッセージが送信されない。<br>
  リクエストの確認ボタンで、エンドポイントに対して送られたjsonに含まれるURLにアクセスして<br>
  ステータスを確認済みにする必要がある。<br>
</p>
<p>
  jsonは以下のようなものが来る。<br>
  <pre>
    <code class="json">
      {
        "Type" : "SubscriptionConfirmation",
        "MessageId" : "165545c9-2a5c-472c-8df2-7ff2be2b3b1b",
        "Token" : "2336412f37fb687f5d51e6e241d09c805a5a5...",
        "TopicArn" : "arn:aws:sns:us-west-2:123456789012:MyTopic",
        "Message" : "You have chosen to subscribe to the topic ...",
        "SubscribeURL" : "https://sns.us-west-2.amazonaws.com/?Action=Confirm...",
        "Timestamp" : "2012-04-26T20:45:04.751Z",
        "SignatureVersion" : "1",
        "Signature" : "EXAMPLEpH+DcEwjAPg8O9mY8dReBSwksfg2S7WKQcikcNKW...",
        "SigningCertURL" : "https://sns.us-west-2.amazonaws.com/SimpleNo..."
      }
    </code>
  </pre>
</p>
<p>
  このjsonに含まれるSubscribeURLが認証用のURLである。<br>
  ということでSNSメッセージの最終的な取得コードは以下。<br>
  <pre>
    <code class="php">
      $body = json_encode(file_get_contents('php://input'), true);
      file_get_contents($body['SubscribeURL']); // URLを叩いて認証する
      var_dump($body["Message"]); // hoge
    </code>
  </pre>
</p>
<h3>アプリケーションからメッセージを発行する</h3>
<p>
  あとで書く
</p>
EOF
  }
])
